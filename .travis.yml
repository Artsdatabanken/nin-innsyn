language: node_js
node_js:
- '10'
directories:
- node_modules
script:
- yarn test
- yarn build
before_deploy:
- git tag "$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)"
- echo "$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)"
- ls -la build
deploy:
  provider: releases
  api_key:
    secure: W+Gc7iOpOG55EVIYya7lDzUibg0IgfVAAtbjxgTbm2msg0e9p3wA+pm4g1xTatjOlVRu8HGD3ZkxAXA0V4XJmQYw3Zu4aa1gGJtQXTsxgOw8LDiy7c89E0ndmL2oVrWwE+kwq7o7sr/j2UkZxdHX/fg2fBDMVDjSUjur1uHFWIqAHwjdFNhwSbzxMCMa5ifKPkuzzAoXwLK67akv6XBWwMA3xBlI8MrJh0jUKplRQXugbPSdCvXlnQR1rENwOAFQbKozuQx0vst6/MirhXAimlnyNZMxtnC9OXXs38YYy6eKgD0qD7vr4EyK0HPHBfCw2SWYIHAewnjciesb0dSK0NsHkq52lPz9HL8y3SwNdD/Y0hI19zUJqUOuQFha32XNPgwuAvmaVUomFQy2xkt8BFJ8keHhbk/UxMM7zYDVJivL3XAjw06y1PMBn+d9B5512yHm5Ms9lRn3qhx62U3VcBsh514BLFh9cZPfHu/3C/EzHHbUF7xR391HL5nJOcGvTQFELM3XkYSAJkGYGCdN5qRL91VK0oURuMfvU5CneI2fZtG+m9DzybibaVXqQt7lW2Y444yxugF2ixrL37bB5b21Qyq4bVEVtvCh0FUuio6/eBOZjmad6JlpzcSVizI7epMM91VTwupXsQ2+DYJzqO3h+oXoZbyozGzOwmtEhsA=
  file: build/*
  on:
    repo: Artsdatabanken/ratatouille
  skip_cleanup: true
after_deploy:
  notifications:
    slack:
      template:
      - release %{repository_slug}
after_success:
- npm run report-coverage
notifications:
  slack:
    secure: boRuTnFbZmvMYN4U4cqEhd3TAetZrHC2uUNmrLu/oEgKMWRtBQMJATiV/dYuYki1zWz1OeF97dAwAZnJpDCH7S4Sv+Dskn75HUj0NAVKfxR/mH/MiQupNLe4eN3+5FfhzdQW+n8m/rLcnPT5RuAd4+xjUeGc4aAPuYPpi8IMKoIV6aXRSNBpZMGpjQuyV6DZMhUr5Rr/WUD0DwxJSzbXZsNFUdefVBrogeLl9GKcxWapSNSED3tzZyG7MexfiD3cdw6GWpwuAmNjKyTe2BA8aESUvuBcOPSk/z7ZqAxC0GOW8BEikEMowAK+nVUOYL4bbyTBvpa1808Fu9EWBxreBNH9nwG91s+zXLmNFt+cLMp6rozedPG6JuOCT4tDHdqRrrCubNmpNVczn1iY6iyPj1q7Cvk+s+kfugrdedmqr/aYhatnirGGxdAbHAluizkwAzbzP6gnD4i2FdxefJ77hrAI80Y/6wMzPHTWVCgVUZEyBZb6J+1C7JvcEinsnNC0MkOdvGBcCNUHEGc+L/clYhVN5W4CoqP5QxuatZjYhfPlIe4D4v51wgttu4IQN7FztZwvSzSVMKdONtbhFv3jOuyKsm/KQONEBs+7o9exNm5pPR1GLJfpjNO9vJJJ9K3b8ene+L0Irnv0SWu/mpl0+shbAkfrrQX9MJUT3ntXuaM=
before_install:
- yarn global add greenkeeper-lockfile@1
- export PATH=$PATH:`yarn global bin`
before_script: greenkeeper-lockfile-update
after_script: greenkeeper-lockfile-upload
